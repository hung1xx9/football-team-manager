import{_ as V,g as h,h as N,c as p,a as d,b as t,t as l,f as _,F as D,r as S,w as b,v as x,i as M,e as T,B,o as r,n as I}from"./index-5ced725b.js";const Q={class:"page-content"},L={class:"card"},F={class:"card-content"},G={class:"stats-grid",style:{"grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))","margin-bottom":"2rem"}},$={class:"stat-card stat-info"},q={class:"stat-content"},A={class:"stat-value"},U={class:"stat-card stat-warning"},z={class:"stat-content"},E={class:"stat-value"},K={class:"payment-actions"},O={key:0,class:"my-payments-history"},X={class:"table-container"},j={class:"data-table"},H={style:{"font-weight":"600"}},J={key:1,class:"empty-state"},R={key:0,class:"modal",style:{display:"flex"}},W={class:"modal-content"},Y={class:"modal-header"},Z={class:"modal-body"},tt={class:"form-group"},et={class:"form-group"},nt={__name:"MyPaymentsView",setup(st){const{members:m,transactions:w,addTransaction:P}=T(),{guestMemberId:o}=B(),u=h(!1),i=h("fund"),s=N({amount:0,note:""}),v=p(()=>o.value?m.value.find(e=>e.id===o.value)||{fundPaid:0,fines:0}:{fundPaid:0,fines:0}),f=p(()=>o.value?w.value.filter(n=>n.memberId===o.value&&(n.category==="fund"||n.category==="fine")).sort((n,e)=>new Date(e.date)-new Date(n.date)):[]),y=n=>{i.value=n,s.amount=0,s.note="",u.value=!0},g=()=>{u.value=!1},k=()=>{if(!s.amount||s.amount<=0){alert("Vui lòng nhập số tiền hợp lệ");return}if(!o.value){alert("Không tìm thấy thông tin thành viên");return}P({type:"expense",category:i.value,amount:s.amount,description:s.note||(i.value==="fund"?"Đóng quỹ":"Đóng phạt"),date:new Date().toISOString().split("T")[0],memberId:o.value});const n=m.value.find(e=>e.id===o.value);n&&(i.value==="fund"?n.fundPaid=(n.fundPaid||0)+s.amount:n.fines=(n.fines||0)+s.amount),alert(`✅ Đã ${i.value==="fund"?"đóng quỹ":"đóng phạt"} thành công!`),g()},c=n=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(n),C=n=>n?new Date(n).toLocaleDateString("vi-VN"):"";return(n,e)=>(r(),d("div",Q,[t("div",L,[e[11]||(e[11]=t("div",{class:"card-header"},[t("h2",null,"Đóng Quỹ & Phạt")],-1)),t("div",F,[t("div",G,[t("div",$,[t("div",q,[e[4]||(e[4]=t("div",{class:"stat-label"},"Quỹ Đã Đóng",-1)),t("div",A,l(c(v.value.fundPaid)),1)])]),t("div",U,[t("div",z,[e[5]||(e[5]=t("div",{class:"stat-label"},"Phạt Đã Đóng",-1)),t("div",E,l(c(v.value.fines)),1)])])]),t("div",K,[t("button",{class:"btn btn-primary",onClick:e[0]||(e[0]=a=>y("fund"))},[...e[6]||(e[6]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),t("line",{x1:"5",y1:"12",x2:"19",y2:"12"})],-1),_(" Đóng Quỹ ",-1)])]),t("button",{class:"btn btn-warning",onClick:e[1]||(e[1]=a=>y("fine"))},[...e[7]||(e[7]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("circle",{cx:"12",cy:"12",r:"10"}),t("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),t("line",{x1:"9",y1:"9",x2:"15",y2:"15"})],-1),_(" Đóng Phạt ",-1)])])]),f.value.length>0?(r(),d("div",O,[e[9]||(e[9]=t("h3",{style:{margin:"2rem 0 1rem"}},"Lịch Sử Đóng Tiền",-1)),t("div",X,[t("table",j,[e[8]||(e[8]=t("thead",null,[t("tr",null,[t("th",null,"Ngày"),t("th",null,"Loại"),t("th",null,"Số Tiền"),t("th",null,"Ghi Chú")])],-1)),t("tbody",null,[(r(!0),d(D,null,S(f.value,a=>(r(),d("tr",{key:a.id},[t("td",null,l(C(a.date)),1),t("td",null,[t("span",{class:I(["badge",a.type==="fund"?"badge-info":"badge-warning"])},l(a.type==="fund"?"Quỹ":"Phạt"),3)]),t("td",H,l(c(a.amount)),1),t("td",null,l(a.note||"-"),1)]))),128))])])])])):(r(),d("div",J,[...e[10]||(e[10]=[t("p",null,"Chưa có lịch sử đóng tiền",-1)])]))])]),u.value?(r(),d("div",R,[t("div",W,[t("div",Y,[t("h2",null,l(i.value==="fund"?"Đóng Quỹ":"Đóng Phạt"),1),t("button",{class:"modal-close",onClick:g},"x")]),t("div",Z,[t("div",tt,[e[12]||(e[12]=t("label",null,"Số Tiền",-1)),b(t("input",{type:"number","onUpdate:modelValue":e[2]||(e[2]=a=>s.amount=a),placeholder:"Nhập số tiền",min:"0"},null,512),[[x,s.amount,void 0,{number:!0}]])]),t("div",et,[e[13]||(e[13]=t("label",null,"Ghi Chú",-1)),b(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=a=>s.note=a),rows:"3",placeholder:"Ghi chú (tùy chọn)"},null,512),[[x,s.note]])]),t("div",{class:"form-actions"},[t("button",{class:"btn btn-primary",onClick:k},"Xác Nhận")])])])])):M("",!0)]))}},ot=V(nt,[["__scopeId","data-v-b5e6a785"]]);export{ot as default};
