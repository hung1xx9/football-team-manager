import{_ as A,g as u,h as j,a,b as t,f as h,F as p,r as g,u as v,t as d,w as c,j as q,v as b,i as f,o as l,n as V,k as z,e as F}from"./index-5ced725b.js";import{u as X}from"./useQRAttendance-a530ed36.js";const E={class:"page-content"},O={class:"page-actions"},G={class:"matches-list"},H={class:"match-card-header"},J={class:"match-card-title"},K={class:"match-card-date"},P={class:"match-card-date"},W={class:"match-card-date"},Y={style:{"text-align":"right","margin-top":"4px"}},Z={class:"badge badge-success"},tt={class:"badge badge-danger"},et={class:"match-card-body"},st={class:"attendance-grid"},nt={key:0,class:"attendance-item"},ot={class:"attendance-name"},at={style:{"margin-top":"1rem",display:"flex",gap:"0.5rem","justify-content":"flex-end","flex-wrap":"wrap"}},lt=["onClick"],dt=["onClick"],it=["onClick"],rt={key:0,class:"modal",style:{display:"flex"}},ct={class:"modal-content modal-large"},ut={class:"modal-header"},pt={class:"modal-body"},vt={class:"form-group"},mt={class:"form-group"},_t={class:"form-group"},yt={class:"form-group"},ht={class:"form-group"},gt={class:"attendance-list"},bt=["id","value"],ft=["for"],xt={key:1,class:"modal",style:{display:"flex"}},kt={class:"modal-content",style:{"max-width":"450px","text-align":"center"}},Tt={class:"modal-body"},wt={key:0},Mt={style:{"margin-bottom":"1rem",color:"var(--text-secondary)"}},Ct=["src"],Vt={key:1,style:{padding:"2rem"}},It={__name:"MatchesView",setup(Qt){const{sortedMatches:I,members:Q,getMemberName:x,saveMatch:R,deleteMatch:D}=F(),{generateQR:S}=X(),m=u(!1),_=u(!1),r=u(null),y=u(null),o=j({id:null,date:"",matchType:"friendly",opponent:"",location:"",attendanceIds:[]}),k=(n=null)=>{n?(o.id=n.id,o.date=n.date,o.matchType=n.matchType||"friendly",o.opponent=n.opponent,o.location=n.location,o.attendanceIds=n.attendance.filter(e=>e.status==="present").map(e=>e.memberId)):(o.id=null,o.date=new Date().toISOString().split("T")[0],o.matchType="friendly",o.opponent="",o.location="",o.attendanceIds=[]),m.value=!0},T=()=>m.value=!1,B=()=>{R({...o}),T()},N=n=>{confirm("Xóa trận này?")&&D(n)},$=async n=>{y.value=n,_.value=!0,r.value=null;const e=await S(n.id,n.date);r.value=e},U=()=>{_.value=!1,r.value=null,y.value=null},w=n=>n?new Date(n).toLocaleDateString("vi-VN"):"",M=n=>{if(!n)return"";const e=n.matchType==="friendly"?"Đấu tập":"Đấu đối",s=w(n.date);return`Trận ${e} ${s}`},L=n=>n==="friendly"?"badge-info":"badge-warning",C=(n,e)=>n.attendance.filter(s=>s.status===e).length;return(n,e)=>(l(),a("div",E,[t("div",O,[t("button",{class:"btn btn-primary",onClick:e[0]||(e[0]=s=>k())},[...e[6]||(e[6]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),t("line",{x1:"5",y1:"12",x2:"19",y2:"12"})],-1),h(" Thêm Trận Đấu ",-1)])])]),t("div",G,[(l(!0),a(p,null,g(v(I),s=>(l(),a("div",{class:"match-card",key:s.id},[t("div",H,[t("div",null,[t("div",J,d(M(s)),1),t("div",K,[t("span",{class:V(["badge",L(s.matchType)])},d(s.matchType==="friendly"?"Đấu tập":"Đấu đối"),3),h(" "+d(s.opponent||"Chưa có đối thủ"),1)]),t("div",P,d(s.location||"Chưa có địa điểm"),1)]),t("div",null,[t("div",W,d(w(s.date)),1),t("div",Y,[t("span",Z,d(C(s,"present"))+" có mặt",1),t("span",tt,d(C(s,"absent"))+" vắng",1)])])]),t("div",et,[t("div",st,[(l(!0),a(p,null,g(s.attendance,i=>(l(),a(p,{key:i.memberId},[v(x)(i.memberId)?(l(),a("div",nt,[t("div",{class:V(["attendance-status",i.status])},null,2),t("div",ot,d(v(x)(i.memberId)),1)])):f("",!0)],64))),128))]),t("div",at,[t("button",{class:"btn btn-sm btn-info",onClick:i=>$(s)},[...e[7]||(e[7]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),t("path",{d:"M3 9h18"}),t("path",{d:"M9 21V9"})],-1),h(" Mã QR ",-1)])],8,lt),t("button",{class:"btn btn-sm btn-primary",onClick:i=>k(s)}," Sửa/Điểm danh ",8,dt),t("button",{class:"btn btn-sm btn-danger",onClick:i=>N(s.id)},"Xóa",8,it)])])]))),128))]),m.value?(l(),a("div",rt,[t("div",ct,[t("div",ut,[t("h2",null,d(o.id?"Sửa":"Thêm")+" Trận Đấu",1),t("button",{class:"modal-close",onClick:T},"x")]),t("div",pt,[t("div",vt,[e[9]||(e[9]=t("label",null,"Loại Trận Đấu",-1)),c(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>o.matchType=s)},[...e[8]||(e[8]=[t("option",{value:"friendly"},"Đấu tập",-1),t("option",{value:"competitive"},"Đấu đối",-1)])],512),[[q,o.matchType]])]),t("div",mt,[e[10]||(e[10]=t("label",null,"Ngày",-1)),c(t("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=s=>o.date=s)},null,512),[[b,o.date]])]),t("div",_t,[e[11]||(e[11]=t("label",null,"Đối Thủ",-1)),c(t("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=s=>o.opponent=s),placeholder:"Tên đội đối thủ"},null,512),[[b,o.opponent]])]),t("div",yt,[e[12]||(e[12]=t("label",null,"Địa Điểm",-1)),c(t("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=s=>o.location=s),placeholder:"Sân vận động"},null,512),[[b,o.location]])]),t("div",ht,[e[13]||(e[13]=t("label",null,"Điểm Danh",-1)),t("div",gt,[(l(!0),a(p,null,g(v(Q),s=>(l(),a("div",{class:"attendance-checkbox",key:s.id},[c(t("input",{type:"checkbox",id:"att-"+s.id,value:s.id,"onUpdate:modelValue":e[5]||(e[5]=i=>o.attendanceIds=i)},null,8,bt),[[z,o.attendanceIds]]),t("label",{for:"att-"+s.id},d(s.name),9,ft)]))),128))])]),t("div",{class:"form-actions"},[t("button",{class:"btn btn-primary",onClick:B},"Lưu")])])])])):f("",!0),_.value?(l(),a("div",xt,[t("div",kt,[t("div",{class:"modal-header"},[e[14]||(e[14]=t("h2",null,"Mã QR Điểm Danh",-1)),t("button",{class:"modal-close",onClick:U},"x")]),t("div",Tt,[r.value?(l(),a("div",wt,[t("p",Mt,d(M(y.value)),1),t("img",{src:r.value,alt:"QR Code",style:{width:"100%","max-width":"300px","border-radius":"var(--radius-lg)",margin:"0 auto"}},null,8,Ct),e[15]||(e[15]=t("p",{style:{"margin-top":"1rem","font-size":"0.875rem",color:"var(--text-muted)"}}," Thành viên quét mã này để điểm danh ",-1))])):(l(),a("div",Vt,[...e[16]||(e[16]=[t("div",{class:"spinner"},null,-1),t("p",null,"Đang tạo mã QR...",-1)])]))])])])):f("",!0)]))}},St=A(It,[["__scopeId","data-v-670ed5dd"]]);export{St as default};
